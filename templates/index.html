<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Taxi EFTPOS Statement Generator</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css">
    <style>
      body { max-width: 900px; margin: 2rem auto; }
      header { margin-bottom: 1rem; }
    </style>
  </head>
  <body>
    <header>
      <h2>Taxi EFTPOS Statement</h2>
    </header>
    {% with messages = get_flashed_messages() %}
      {% if messages %}
        <article>
          {% for msg in messages %}
            <p>{{ msg }}</p>
          {% endfor %}
        </article>
      {% endif %}
    {% endwith %}
    <main>
      <form action="{{ url_for('generate') }}" method="post" enctype="multipart/form-data">
        <fieldset>
          <label>Report Type
            <select name="report_type">
              <option value="eftpos">Taxi EFTPOS Statement</option>
              <option value="tss">Taxi TSS Statement</option>
            </select>
          </label>
          <label>Period Start (Last Monday)
            <input type="date" name="period_start" value="{{ default_start }}" required />
          </label>
          <label>Period End (Next Sunday)
            <input type="date" name="period_end" value="{{ default_end }}" required />
          </label>
          <label>Date Issued
            <input type="date" name="date_issued" value="{{ default_issued }}" required />
          </label>
        </fieldset>
        <fieldset>
          <label>Upload CSV files
            <input type="file" name="csv_files" accept=".csv" multiple required />
          </label>
        </fieldset>
        <button type="submit">Generate PDFs</button>
      </form>
      <hr />
      {% if uploads_dir is defined and uploads_dir %}
        <p><small>Uploads folder: <code>{{ uploads_dir }}</code> —
          <a target="_blank" rel="noopener" href="{{ ('file:///' + uploads_dir + '/') | replace('\\','/') | replace(' ', '%20') }}">Open</a>
        </small></p>
      {% else %}
        <p><small>Uploads folder: <code>{{ '' }}</code></small></p>
      {% endif %}

      {% if output_dir is defined and output_dir %}
        <p><small>Output folder: <code>{{ output_dir }}</code> —
          <a target="_blank" rel="noopener" href="{{ ('file:///' + output_dir + '/') | replace('\\','/') | replace(' ', '%20') }}">Open</a>
        </small></p>
      {% else %}
        <p><small>Output folder: <code>{{ '' }}</code></small></p>
      {% endif %}
    </main>
  </body>
</html>
